<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>ConferÃªncia de Ãrea</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>

<body>
<h2>ğŸ“¦ ConferÃªncia de Ãrea</h2>

Ãrea <input id="area"><br><br>
SKU <input id="sku"><br><br>
Quantidade atual <input id="qtd" type="number"><br><br>

<button onclick="confirmar()">Confirmar / Atualizar</button>
<p id="msg"></p>

<script>
const supabase = window.supabase.createClient(
  'https://qfjghplxbtogshfjkawx.supabase.co',
  'sb_publishable_rIcKdaflOvJ0DLTJDcOrxA_bpTGG2hA'
)

async function confirmar() {
  const area = document.getElementById('area').value
  const sku = document.getElementById('sku').value
  const qtd = Number(document.getElementById('qtd').value)

  const { data: existente } = await supabase
    .from('estoque')
    .select('id')
    .eq('area', area)
    .eq('sku', sku)
    .single()

  if (existente) {
    await supabase
      .from('estoque')
      .update({ quantidade: qtd })
      .eq('id', existente.id)

    msg.innerText = 'Quantidade atualizada com sucesso'
  } else {
    await supabase
      .from('estoque')
      .insert({ area, sku, quantidade: qtd })

    msg.innerText = 'SKU inserido na Ã¡rea'
  }
}
</script>
</body>
</html>
